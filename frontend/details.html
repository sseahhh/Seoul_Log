<!DOCTYPE html>
<html class="light" lang="ko"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ì˜ì•ˆ ìƒì„¸ ì •ë³´</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<style>
      body {
        font-family: "Public Sans", "Noto Sans KR", sans-serif;
      }
    </style>
<script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#00559F",
              "background-light": "#F5F7FA",
              "background-dark": "#101622",
              "accent": "#FFC107"
            },
            fontFamily: {
              "display": ["Public Sans", "Noto Sans KR", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
<style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  </head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden mx-auto max-w-lg">
<header class="sticky top-0 z-10 flex items-center bg-white dark:bg-slate-900 p-4 pb-2 justify-between border-b border-slate-200 dark:border-slate-800">
<button class="text-[#212121] dark:text-white flex size-12 shrink-0 items-center justify-start">
<span class="material-symbols-outlined">arrow_back</span>
</button>
<h1 class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] flex-1 text-center">ì˜ì•ˆ ìƒì„¸ ì •ë³´</h1>
<div class="flex size-12 shrink-0 items-center"></div>
</header>
<main class="flex flex-col flex-grow">
<div class="p-4 pt-6">
<div class="flex flex-col items-stretch justify-start rounded-xl">
<div class="flex w-full grow flex-col items-stretch justify-center gap-1">
<p class="text-xs text-[#757575] dark:text-slate-400">ì˜ì•ˆë²ˆí˜¸: 2024-1234</p>
<p class="text-[#212121] dark:text-white text-xl font-bold leading-tight tracking-[-0.015em]">ì„œìš¸íŠ¹ë³„ì‹œ ì£¼ì°¨ì¥ ì„¤ì¹˜ ë° ê´€ë¦¬ ì¡°ë¡€ ì¼ë¶€ê°œì •ì¡°ë¡€ì•ˆ</p>
<div class="flex items-center gap-3 justify-start pt-2">
<div class="flex flex-col gap-1">
<p class="text-[#757575] dark:text-slate-400 text-sm font-normal leading-normal">ì œì•ˆì: ê¹€ì˜ì› ì™¸ 10ì¸</p>
<p class="text-[#757575] dark:text-slate-400 text-sm font-normal leading-normal">ì œì•ˆì¼ì: 2024-05-20</p>
</div>
</div>
</div>
</div>
</div>
<div class="p-4 @container">
<div class="flex flex-col items-stretch justify-start rounded-xl shadow-[0_2px_8px_rgba(0,0,0,0.08)] bg-white dark:bg-slate-800">
<div class="flex w-full grow flex-col items-stretch justify-center gap-4 p-4">
<div>
<p class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] mb-3">í•µì‹¬ ì˜ì œ</p>
<div class="flex flex-col gap-3">
<div class="flex flex-col">
<p class="font-bold text-[#212121] dark:text-white text-base">1. ê³µì˜ì£¼ì°¨ì¥ ìš”ê¸ˆ ì²´ê³„ í˜„ì‹¤í™”</p>
<div class="pl-4 mt-2">
<p class="text-[#757575] dark:text-slate-300 text-sm leading-relaxed"><strong>ë°•ìœ„ì› (ì°¬ì„±):</strong> "ì•¼ê°„ ì£¼ì°¨ ìš”ê¸ˆ í• ì¸ìœ¨ì„ ì¡°ì •í•˜ì—¬ ì£¼ì°¨ì¥ ìš´ì˜ì˜ íš¨ìœ¨ì„±ì„ ë†’ì´ê³ , ìˆ˜ìµì„±ì„ ê°œì„ í•´ì•¼ í•©ë‹ˆë‹¤."</p>
<p class="text-[#757575] dark:text-slate-300 text-sm leading-relaxed mt-1"><strong>ìµœìœ„ì› (ë°˜ëŒ€):</strong> "ì‹œë¯¼ ë¶€ë‹´ì„ ê°€ì¤‘ì‹œí‚¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, í• ì¸ìœ¨ ì¡°ì •ì€ ì‹ ì¤‘í•˜ê²Œ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤."</p>
</div>
</div>
<div class="flex flex-col">
<p class="font-bold text-[#212121] dark:text-white text-base">2. ì „ê¸°ì°¨ ì¶©ì „ êµ¬ì—­ ê´€ë¦¬ ê°•í™”</p>
<div class="pl-4 mt-2">
<p class="text-[#757575] dark:text-slate-300 text-sm leading-relaxed"><strong>ê¹€ìœ„ì› (ì°¬ì„±):</strong> "ì¶©ì „ ë°©í•´ í–‰ìœ„ì— ëŒ€í•œ ê³¼íƒœë£Œë¥¼ ìƒí–¥í•˜ì—¬, ì „ê¸°ì°¨ ì´ìš©ìë“¤ì˜ í¸ì˜ë¥¼ ë³´ì¥í•´ì•¼ í•©ë‹ˆë‹¤."</p>
</div>
</div>
</div>
</div>
<div class="border-t border-slate-200 dark:border-slate-700 mt-4"></div>
<details class="flex flex-col group pt-4" open="">
<summary class="flex cursor-pointer items-center justify-between gap-6 py-1">
<p class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">ì‰¬ìš´ ìš©ì–´ ì„¤ëª…</p>
<div class="text-[#212121] dark:text-white group-open:rotate-180 transition-transform">
<span class="material-symbols-outlined">expand_more</span>
</div>
</summary>
<div class="pt-2 flex flex-col gap-2">
<div class="flex items-start gap-2">
<span class="material-symbols-outlined text-primary text-xl mt-0.5">help_outline</span>
<p class="text-[#757575] dark:text-slate-300 text-sm font-normal leading-normal flex-1"><strong class="font-medium text-[#212121] dark:text-white">ì¡°ë¡€:</strong> ì„œìš¸ì‹œì™€ ê°™ì´ íŠ¹ì • ì§€ì—­ì—ì„œë§Œ ì ìš©ë˜ëŠ” ë²•ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
</div>
<div class="flex items-start gap-2">
<span class="material-symbols-outlined text-primary text-xl mt-0.5">help_outline</span>
<p class="text-[#757575] dark:text-slate-300 text-sm font-normal leading-normal flex-1"><strong class="font-medium text-[#212121] dark:text-white">ê³¼íƒœë£Œ:</strong> ë²•ê·œë¥¼ ìœ„ë°˜í–ˆì„ ë•Œ ë‚´ëŠ” ë²Œê¸ˆê³¼ ë¹„ìŠ·í•œ ê°œë…ì…ë‹ˆë‹¤.</p>
</div>
</div>
</details>
</div>
</div>
</div>
<div class="p-4 pt-8">
<button class="flex w-full items-center justify-center gap-2 rounded-lg bg-primary px-6 py-3 text-base font-bold text-white transition-colors hover:bg-primary/90">
<span>ì˜ì•ˆ ì›ë¬¸ ì „ì²´ ë³´ê¸°</span>
<span class="material-symbols-outlined">arrow_forward</span>
</button>
</div>
<div class="px-4 py-6">
<h2 class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] pb-3">í•¨ê»˜ ë³´ë©´ ì¢‹ì€ ê´€ë ¨ ì˜ì•ˆ</h2>
<div class="flex flex-col gap-3">
<div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4">
<p class="text-[#212121] dark:text-white font-bold leading-tight">ì„œìš¸íŠ¹ë³„ì‹œ ì „ê¸°ìë™ì°¨ ì´ìš© í™œì„±í™” ì¡°ë¡€ ì¼ë¶€ê°œì •ì¡°ë¡€ì•ˆ</p>
<p class="text-[#757575] dark:text-slate-400 text-sm mt-1">ì „ê¸°ì°¨ ì¶©ì „ ì¸í”„ë¼ í™•ì¶© ë° ë³´ì¡°ê¸ˆ ì§€ì› í™•ëŒ€ì— ê´€í•œ ë‚´ìš©ì„ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.</p>
</div>
<div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4">
<p class="text-[#212121] dark:text-white font-bold leading-tight">ì„œìš¸íŠ¹ë³„ì‹œ ê³µìœ ì£¼ì°¨ì¥ í™œì„±í™” ì§€ì› ì¡°ë¡€ì•ˆ</p>
<p class="text-[#757575] dark:text-slate-400 text-sm mt-1">ìœ íœ´ ì£¼ì°¨ ê³µê°„ì„ ê³µìœ í•˜ì—¬ ì£¼ì°¨ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì§€ì›ì±…ì„ ë§ˆë ¨í•©ë‹ˆë‹¤.</p>
</div>
</div>
</div>
</main>
<nav class="sticky bottom-0 z-10 flex justify-around border-t border-slate-200 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm">
<a class="flex flex-col items-center gap-1 p-3 text-primary" href="#">
<span class="material-symbols-outlined">home</span>
<span class="text-xs font-medium">í™ˆ</span>
</a>
<a class="flex flex-col items-center gap-1 p-3 text-[#757575] dark:text-slate-400" href="#">
<span class="material-symbols-outlined">search</span>
<span class="text-xs font-medium">ê²€ìƒ‰</span>
</a>
<a class="flex flex-col items-center gap-1 p-3 text-[#757575] dark:text-slate-400" href="#">
<span class="material-symbols-outlined">person</span>
<span class="text-xs font-medium">ë§ˆì´í˜ì´ì§€</span>
</a>
</nav>
</div>

<script>
// URLì—ì„œ agenda_id ê°€ì ¸ì˜¤ê¸°
const urlParams = new URLSearchParams(window.location.search);
const agendaId = urlParams.get('agenda_id');

if (!agendaId) {
  alert('ì•ˆê±´ IDê°€ ì—†ìŠµë‹ˆë‹¤.');
  window.location.href = '/';
}

// ì•ˆê±´ ìƒì„¸ ì •ë³´ ë¡œë“œ (í¬ë§·ëœ ë²„ì „)
async function loadAgendaDetail() {
  try {
    const response = await fetch(`/api/agenda/${agendaId}/formatted-detail`);

    if (!response.ok) {
      throw new Error('ì•ˆê±´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
    }

    const data = await response.json();

    // í˜ì´ì§€ì— ë°ì´í„° í‘œì‹œ
    displayFormattedAgendaDetail(data);
  } catch (error) {
    console.error('Error:', error);
    alert('ì•ˆê±´ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
  }
}

function displayFormattedAgendaDetail(data) {
  // í”„ë¡¬í”„íŠ¸ ê·œì¹™ì— ë”°ë¥¸ í‘œì‹œ:
  // 1. ìµœìƒë‹¨ ì œëª©: agenda_title
  // 2. ì•ˆê±´ì˜ ì„¸ë¶€ ë‚´ìš© ìš”ì•½ (3-6ì¤„)
  // 3. ì²¨ë¶€ ë¬¸ì„œê°€ ìˆì„ ê²½ìš° ë‚˜ì—´ (ì†Œì£¼ì œ + ìš”ì•½)

  // ì˜ì•ˆë²ˆí˜¸ (agenda_id)
  document.querySelector('.text-xs.text-\\[\\#757575\\]').textContent = `ì˜ì•ˆ: ${agendaId}`;

  // ì œëª© (agenda_title)
  document.querySelector('.text-xl.font-bold').textContent = data.agenda_title;

  // ì œì•ˆì ì •ë³´ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ (í”„ë¡¬í”„íŠ¸ì— ì—†ìŒ)
  const infoDiv = document.querySelector('.flex.flex-col.gap-1');
  infoDiv.innerHTML = '';

  // ì•ˆê±´ì˜ ì„¸ë¶€ ë‚´ìš© ìš”ì•½ (3-6ì¤„) - ai_summary ì‚¬ìš©
  const issuesContainer = document.querySelector('.flex.flex-col.items-stretch.justify-start.rounded-xl.shadow-\\[0_2px_8px_rgba\\(0\\,0\\,0\\,0\\.08\\)\\]');
  issuesContainer.querySelector('.flex.w-full.grow.flex-col').innerHTML = `
    <div>
      <p class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] mb-3">ì•ˆê±´ì˜ ì„¸ë¶€ ë‚´ìš© ìš”ì•½</p>
      <p class="text-[#757575] dark:text-slate-300 text-base leading-relaxed whitespace-pre-line">${data.summary}</p>
    </div>
    ${data.attachments && data.attachments.length > 0 ? `
      <div class="border-t border-slate-200 dark:border-slate-700 mt-4 pt-4">
        <p class="text-[#212121] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] mb-3">ì²¨ë¶€ ë¬¸ì„œ</p>
        <div class="flex flex-col gap-4">
          ${data.attachments.map(attachment => `
            <div>
              <p class="font-bold text-[#212121] dark:text-white text-base mb-2">ğŸ“ ${attachment.title || 'ì œëª© ì—†ìŒ'}</p>
              ${attachment.summary ? `<p class="text-[#757575] dark:text-slate-300 text-sm leading-relaxed pl-4">${attachment.summary}</p>` : ''}
            </div>
          `).join('')}
        </div>
      </div>
    ` : ''}
  `;

  // ì‰¬ìš´ ìš©ì–´ ì„¤ëª…ê³¼ ê´€ë ¨ ì˜ì•ˆ ì„¹ì…˜ ì œê±° (í”„ë¡¬í”„íŠ¸ì— ì—†ìŒ)
  const detailsElement = document.querySelector('details');
  if (detailsElement) {
    detailsElement.style.display = 'none';
  }

  const relatedSection = document.querySelector('.px-4.py-6');
  if (relatedSection) {
    relatedSection.style.display = 'none';
  }

  // ì˜ì•ˆ ì›ë¬¸ ì „ì²´ ë³´ê¸° ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½
  const fullTextButton = document.querySelector('button.bg-primary span:first-child');
  if (fullTextButton) {
    fullTextButton.textContent = 'íšŒì˜ë¡ ì „ì²´ ë‚´ìš© ë³´ê¸°';
  }

  // íšŒì˜ë¡ ì „ì²´ ë‚´ìš© ë³´ê¸° ê¸°ëŠ¥
  const fullTextBtn = document.querySelector('button.bg-primary');
  if (fullTextBtn) {
    fullTextBtn.onclick = () => {
      // ìƒˆ ì„¹ì…˜ ì¶”ê°€í•˜ì—¬ combined_text í‘œì‹œ
      const existingFullText = document.getElementById('full-text-section');
      if (existingFullText) {
        existingFullText.remove();
      } else {
        const fullTextSection = document.createElement('div');
        fullTextSection.id = 'full-text-section';
        fullTextSection.className = 'p-4 pt-0';
        fullTextSection.innerHTML = `
          <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4">
            <p class="text-[#212121] dark:text-white text-lg font-bold mb-3">íšŒì˜ë¡ ì „ì²´ ë‚´ìš©</p>
            <div class="max-h-96 overflow-y-auto">
              <p class="text-[#757575] dark:text-slate-300 text-sm leading-relaxed whitespace-pre-line">${data.combined_text}</p>
            </div>
          </div>
        `;
        fullTextBtn.parentElement.after(fullTextSection);
        fullTextBtn.querySelector('span:first-child').textContent = 'íšŒì˜ë¡ ì „ì²´ ë‚´ìš© ë‹«ê¸°';
      }
    };
  }
}

// ë’¤ë¡œê°€ê¸° ë²„íŠ¼
document.querySelector('button.text-\\[\\#212121\\]').onclick = () => {
  window.history.back();
};

// í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
loadAgendaDetail();
</script>
<!-- Floating Chatbot Button -->
<a href="/chat" class="fixed bottom-20 right-6 bg-primary text-white rounded-full p-4 shadow-lg hover:bg-primary/90 transition-transform hover:scale-110 z-30">
  <span class="material-symbols-outlined">
    question_answer
  </span>
</a>
</body></html>
