# 2025년 새싹 해커톤(SeSAC Hackathon) AI 서비스 기획서

## 팀 정보
- **팀명**: 불협화음
- **팀 구성원**: 손용훈(팀장), 성정현, 심세아

---

## 1. AI 서비스 명칭
**서울록(SeoulLog)**

---

## 2. 활용 인공지능 학습용 데이터

| 번호 | 활용 데이터명 | 분야 | 출처 |
|------|--------------|------|------|
| 1 | 서울특별시의회 회의록 | 공공행정/정치 | [서울특별시의회 회의록](https://ms.smc.seoul.kr/kr/assembly/main.do) |

---

## 3. 핵심내용

서울시의회 회의록 검색 기능을 **의미 기반 검색(Semantic Search)**으로 개선하여, 사용자가 원하는 안건을 빠르고 정확하게 찾을 수 있도록 돕는 AI 검색 서비스입니다.

### 주요 기능

#### (1) 안건 단위 시맨틱 검색
- **벡터 기반 검색**: ChromaDB + OpenAI text-embedding-3-small 임베딩
- **하이브리드 검색**: 벡터 유사도 + 메타데이터 필터링(발언자, 날짜, 안건명)
- **관련도 점수 제공**: 코사인 유사도 기반 검색 결과 정렬
- **안건 단위 결과**: 회의록 전체가 아닌 개별 안건만 표시하여 불필요한 정보 제거

#### (2) 지능형 쿼리 분석
- **자연어 이해**: GPT-4o-mini 기반 쿼리 분석
- **메타데이터 자동 추출**: 발언자, 날짜, 안건 키워드 자동 파싱
- **자동 보정**: "주용태" → "경제실장 주용태" 자동 매칭
- **원본 쿼리 보존**: 추출된 키워드뿐만 아니라 사용자 질문 전체를 벡터 검색에 활용

#### (3) 안건 상세 정보 (구현 예정)
- **핵심 의제 요약**: LLM 기반 자동 요약
- **발언자별 입장 정리**: 찬성/반대 의견 구분
- **의안 진행 상태 시각화**: 접수 → 위원회 심사 → 본회의 심의 → 공포
- **관련 안건 추천**: 벡터 유사도 기반 연관 안건 제시

#### (4) RAG 기반 질의응답 챗봇 (구현 예정)
- **대화형 검색**: 자연어로 질문하면 회의록 기반 답변 제공
- **출처 제공**: 답변과 함께 관련 회의록 링크 제공
- **맥락 유지**: 이전 대화 기억하여 연속 질문 가능

---

## 4. 제안배경 및 목적

### 제안 배경

#### 현행 시스템의 문제점

**1. 낮은 검색 정확도**
- 키워드 단순 매칭으로 관련 없는 결과 다수 포함
- 예: "AI" 검색 시 → "CCTV", "WIFI" 등 무관한 결과 혼재
- 동의어, 유사 표현 검색 불가 ("인공지능" ≠ "AI")

**2. 회의록 단위 검색의 한계**
- 검색 결과가 회의록 전체 단위로 제공
- 원하는 안건 찾기 위해 전체 문서 확인 필요 (평균 50-100페이지)
- PDF/HWP 다운로드 후 수동 검색 필요 (5-10분 소요)

**3. 구조화되지 않은 데이터**
- 회의록이 비정형 텍스트로만 존재
- 발언자, 안건, 날짜 등 메타데이터 추출 불가
- 데이터 분석 및 재활용 어려움

**4. 정보 접근성 문제**
- 법률·행정 전문 용어로 인한 이해 어려움
- 안건 진행 상태 파악 불가
- 모바일 접근성 낮음

### 목적

**1. 검색 정확도 향상**
- 의미 기반 검색으로 관련도 높은 결과만 제공
- 코사인 유사도 85% 이상 결과만 표시

**2. 검색 효율성 증대**
- 안건 단위 검색으로 즉시 접근
- 검색 시간 5-10분 → 30초 이내로 단축

**3. 데이터 구조화**
- 회의록을 안건 단위로 파싱
- JSON 형식으로 저장하여 재활용 가능

**4. 정보 접근성 개선**
- 모바일 최적화 UI
- 쉬운 설명 및 요약 제공
- 챗봇을 통한 대화형 검색

---

## 5. 세부내용

### 시스템 아키텍처

```
[데이터 수집 및 전처리]
서울시의회 회의록 (TXT)
    ↓
Gemini 2.5 Flash (메타데이터 추출)
    ↓
JSON 형식 저장 (안건별 구조화)
    ↓
[데이터베이스 구축]
ChromaDB (벡터 검색) + SQLite (메타데이터)
    ↓
[검색 파이프라인]
Query Analyzer → Metadata Validator → Search Executor → Result Formatter
    ↓
[프론트엔드]
검색 UI (안건 목록) + 상세 페이지 + 챗봇
```

---

### 주요 구현 방법

#### (1) 회의록 파싱 및 구조화

**기술 스택**:
- Gemini 2.5 Flash (65K context window)
- Python (JSON 처리)

**처리 과정**:
```python
1. TXT 회의록 → 15,000자 단위 청킹
2. Gemini API로 각 청크 분석
   - speaker (발언자) 추출
   - agenda (안건) 추출
   - text (발언 내용)
3. Forward-fill로 null 값 채우기
4. JSON 형식으로 저장
```

**출력 예시**:
```json
{
  "meeting_info": {
    "title": "제332회 AI경쟁력강화특별위원회 제3차",
    "date": "2025.09.10",
    "url": "https://ms.smc.seoul.kr/..."
  },
  "chunks": [
    {
      "speaker": "이용균 위원",
      "agenda": "서울특별시 인공지능산업 육성 및 지원 조례안",
      "text": "인공지능산업을 체계적으로 육성..."
    }
  ]
}
```

**현황**: 2개 회의록, 169개 청크 파싱 완료

---

#### (2) 벡터 데이터베이스 구축

**기술 스택**:
- ChromaDB (벡터 데이터베이스)
- OpenAI text-embedding-3-small (1536차원 임베딩)

**데이터 구조**:

**컬렉션 1: `seoul_council_meetings` (청크 단위 - 챗봇용)**
```python
{
    "id": "meeting_20251117_195534_chunk_0005",
    "document": "이용균 위원: 인공지능산업을...",
    "embedding": [0.123, -0.456, ..., 0.234],  # 1536차원
    "metadata": {
        "speaker": "이용균 위원",
        "agenda": "AI 조례안",
        "meeting_date": "2025.09.10",
        "chunk_index": 5
    }
}
```
- 용도: RAG 챗봇, 세밀한 검색
- 문서 수: 169개 (청크 단위)

**컬렉션 2: `seoul_council_agendas` (안건 단위 - 검색 UI용)**
```python
{
    "agenda_id": "meeting_001_agenda_002",
    "agenda_title": "AI 조례안",
    "combined_text": "안건 전체 텍스트 (요약)",
    "main_speaker": "이용균 위원",
    "speakers": "이용균, 김OO, 박OO",
    "chunk_indices": "5,6,7,8,12"  # 원본 청크 추적
}
```
- 용도: 검색 UI (안건별 표시)
- SQLite와 병행하여 메타데이터 관리

---

#### (3) 4-Node 검색 파이프라인

```
사용자 쿼리: "주용태가 AI에 대해 한 말"
    ↓
[Node 1] Query Analyzer (GPT-4o-mini)
    - 메타데이터 추출
      * speaker: "주용태"
      * topic: "AI"
      * agenda: null
      * meeting_date: null
    ↓
[Node 2] Metadata Validator
    - speaker "주용태" → "경제실장 주용태" 자동 보정
    - DB 검증 및 유사 이름 매칭
    ↓
[Node 3] Search Executor
    - 벡터 검색: "주용태가 AI에 대해 한 말" (원본 쿼리)
    - 메타데이터 필터: speaker="경제실장 주용태"
    - 코사인 유사도 계산
    ↓
[Node 4] Result Formatter
    - 유사도 점수 변환: distance → similarity (0-1)
    - JSON 응답 생성
```

**핵심 특징**:
- **원본 쿼리 보존**: 추출된 topic이 아닌 전체 질문으로 벡터 검색
- **자동 보정**: 발언자 이름 오타 및 불완전 입력 처리
- **하이브리드 검색**: 벡터 유사도 + 메타데이터 필터링

---

#### (4) 검색 알고리즘

**벡터 검색 과정**:
```python
# 1. 쿼리 벡터화
query_vector = embedding_function("주용태가 AI에 대해 한 말")
# → [0.234, -0.567, ..., 0.123] (1536차원)

# 2. ChromaDB 검색
results = collection.query(
    query_embeddings=[query_vector],
    n_results=10,
    where={"speaker": "경제실장 주용태"}  # 메타데이터 필터
)

# 3. 코사인 유사도 계산
# distance (0-2) → similarity (0-1)
similarity = (2 - distance) / 2

# 4. 결과 정렬
# 유사도 85% 이상만 표시
```

**장점**:
- 동의어 인식: "AI" ≈ "인공지능"
- 문맥 이해: "경쟁력 강화" ≈ "역량 증대"
- 정확도 향상: 관련도 높은 결과만 표시

---

#### (5) 백엔드 API (FastAPI)

**주요 엔드포인트**:

```python
# 검색 API
POST /api/search
Request:
{
  "query": "AI 경쟁력 강화",
  "n_results": 10
}

Response:
{
  "query": "AI 경쟁력 강화",
  "total_results": 5,
  "results": [
    {
      "title": "AI 조례안",
      "ai_summary": "인공지능산업을...",
      "speaker": "이용균 위원",
      "meeting_date": "2025.09.10",
      "similarity": 0.87,
      "meeting_url": "https://..."
    }
  ]
}
```

```python
# 안건 상세 조회 (구현 예정)
GET /api/agenda/{agenda_id}

Response:
{
  "agenda_id": "meeting_001_agenda_002",
  "agenda_title": "AI 조례안",
  "meeting_info": {...},
  "speakers": [...],
  "key_issues": [...],
  "full_text": "...",
  "related_agendas": [...]
}
```

**특징**:
- 0.0.0.0:8000 바인딩 (모바일 접근 가능)
- CORS 설정
- 에러 처리 및 fallback 메커니즘

---

#### (6) 프론트엔드 UI

**기술 스택**:
- HTML5 + JavaScript (Vanilla)
- Tailwind CSS (디자인 시스템)
- Material Symbols (아이콘)

**주요 페이지**:

**1. 메인 페이지 (`main.html`)**
- 검색창
- 핫이슈 top 5
- 주제별 태그 버튼

**2. 검색 결과 페이지 (`search.html`)**
```
┌─────────────────────────────┐
│  [검색창]                     │
│  검색결과: 5건               │
├─────────────────────────────┤
│  [1] AI 조례안               │
│  AI 요약: ...                │
│  발언자: 이용균 위원          │
│  유사도: 87%                 │
│  [진행 상태 바]              │
├─────────────────────────────┤
│  [2] ...                     │
└─────────────────────────────┘
```

**3. 안건 상세 페이지 (`details.html`) - 구현 예정**
```
┌─────────────────────────────┐
│  의안번호: 2024-1234         │
│  AI 조례안                   │
│  제안자: 이용균 외 10인      │
├─────────────────────────────┤
│  핵심 의제                   │
│  1. 공영주차장 요금...       │
│  2. 전기차 충전...           │
├─────────────────────────────┤
│  쉬운 용어 설명              │
│  [원문 전체 보기 버튼]       │
│  함께 보면 좋은 관련 의안    │
└─────────────────────────────┘
```

**모바일 최적화**:
- 반응형 디자인
- 다크 모드 지원
- 터치 인터페이스

---

### 개발 현황

#### ✅ Phase 1: 데이터 수집 및 파싱 (완료)
- [x] 회의록 TXT 파일 수집
- [x] Gemini API 기반 메타데이터 추출
- [x] JSON 형식 변환
- [x] 2개 회의록, 169개 청크 파싱 완료

#### ✅ Phase 2: 벡터 DB 및 검색 (완료)
- [x] ChromaDB 컬렉션 생성 (청크 단위)
- [x] OpenAI 임베딩 적용
- [x] 4-Node 검색 파이프라인 구현
- [x] 코사인 유사도 계산 수정 (85%+ 정확도)
- [x] 하이브리드 검색 (벡터 + 메타데이터)

#### ✅ Phase 3: 백엔드 API (완료)
- [x] FastAPI 서버 구축
- [x] Query Analyzer (GPT-4o-mini)
- [x] Metadata Validator (자동 보정)
- [x] Search Executor (벡터 검색)
- [x] Result Formatter (응답 생성)
- [x] 에러 처리 및 fallback

#### ✅ Phase 4: 프론트엔드 UI (완료)
- [x] 메인 페이지 (검색창, 핫이슈)
- [x] 검색 결과 페이지
- [x] 동적 렌더링
- [x] 모바일 최적화

#### 🔄 Phase 5: 안건별 저장 및 상세 페이지 (진행 중)
- [x] 안건별 그룹핑 로직
- [ ] SQLite DB 설계 (메타데이터 저장)
- [ ] ChromaDB 안건 컬렉션 생성
- [ ] 안건 상세 페이지 구현
- [ ] 관련 안건 추천

#### 📋 Phase 6: RAG 챗봇 (예정)
- [ ] LangChain/Langgraph 설정
- [ ] 대화 컨텍스트 관리
- [ ] 챗봇 UI 구현
- [ ] 출처 제공 기능

#### 📋 Phase 7: 최적화 (예정)
- [ ] LLM 기반 자동 요약
- [ ] 검색 속도 최적화
- [ ] 캐싱 전략
- [ ] 배포 (ngrok/클라우드)

---

## 6. 기대효과

### 정량적 효과

#### (1) 검색 정확도 향상
- **현재 (키워드 매칭)**: 정확도 약 40-50%
- **개선 (시맨틱 검색)**: 정확도 85% 이상
- **개선율**: 1.7-2.1배 향상

**측정 방법**:
- 코사인 유사도 85% 이상만 표시
- 관련 없는 결과 자동 필터링

#### (2) 검색 시간 단축
- **현재**: 검색 → PDF 다운로드 → 문서 내 검색 (평균 5-10분)
- **개선**: 검색 → 즉시 안건 확인 (평균 30초)
- **단축율**: 10-20배

#### (3) 데이터 구조화
- **현재**: 비정형 텍스트 (PDF/HWP)
- **개선**: JSON 형식 (169개 청크 구조화)
- **활용 가능성**: API 제공, 데이터 분석, 타 서비스 연계

#### (4) 시스템 성능
- **검색 응답 시간**: 1-2초 이내
- **유사도 계산**: 코사인 거리 기반 (정확도 높음)
- **동시 접속**: FastAPI 비동기 처리로 확장 가능

---

### 정성적 효과

#### (1) 정보 접근성 강화
- **쉬운 검색**: 자연어로 질문 가능
- **모바일 지원**: 언제 어디서나 접근
- **시각화**: 안건 진행 상태 한눈에 파악

#### (2) 시민 참여 활성화
- **투명성 향상**: 시의회 활동 쉽게 확인
- **관심 증대**: 검색 편의성으로 이용 증가
- **민주주의 강화**: 정책 결정 과정 이해

#### (3) 행정 효율성 증대
- **공무원**: 선례 검색 시간 절감
- **연구원**: 정책 분석 자료 수집 용이
- **기자**: 취재 자료 신속 확보

#### (4) 기술적 확장성
- **타 지역 확대**: 경기도, 부산 등 적용 가능
- **국회 적용**: 동일 기술로 국회 회의록 검색
- **Open API**: 시민단체, 언론사 활용

---

### 사회적 가치

**1. 정보 민주화**
- 누구나 쉽게 시의회 정보 접근
- 법률·행정 전문 지식 없어도 이해 가능

**2. 데이터 공공재화**
- 구조화된 데이터 무료 제공
- 2차 활용 촉진

**3. AI 기술 공공 활용**
- 최신 AI 기술을 공공 서비스에 적용
- 기술 혁신의 사회적 가치 실현

---

## 7. 기술 스택 요약

### AI/ML
- **LLM**: OpenAI GPT-4o-mini (쿼리 분석), Gemini 2.5 Flash (메타데이터 추출)
- **Embedding**: OpenAI text-embedding-3-small (1536차원)
- **Vector DB**: ChromaDB (코사인 유사도 검색)

### 백엔드
- **Framework**: FastAPI (Python 3.11+)
- **Database**: ChromaDB (벡터), SQLite (메타데이터)
- **Libraries**: OpenAI SDK, custom_openai_embedding

### 프론트엔드
- **UI**: HTML5 + Vanilla JavaScript
- **Styling**: Tailwind CSS
- **Icons**: Material Symbols

### DevOps
- **Version Control**: Git/GitHub
- **Deployment**: ngrok (테스트), 클라우드 (예정)
- **OS**: Windows WSL2 (개발 환경)

---

## 8. 차별화 포인트

### 기존 서비스 대비 우수성

| 비교 항목 | 서울시 기존 검색 | 서울록(SeoulLog) |
|----------|---------------|----------------|
| 검색 방식 | 키워드 단순 매칭 | 의미 기반 벡터 검색 |
| 결과 단위 | 회의록 전체 | 안건 단위 |
| 정확도 | 40-50% | 85%+ |
| 검색 시간 | 5-10분 | 30초 |
| 메타데이터 | 없음 | 발언자, 날짜, 안건 구조화 |
| 모바일 | 불편 | 최적화 |
| 챗봇 | 없음 | RAG 기반 질의응답 |

### 기술적 혁신
1. **4-Node 파이프라인**: 쿼리 분석 → 검증 → 검색 → 포맷팅
2. **자동 보정**: 발언자 이름 유사 매칭
3. **원본 쿼리 보존**: 정보 손실 없는 검색
4. **하이브리드 검색**: 벡터 + 메타데이터 결합

---

## 9. 향후 계획

### 단기 (1개월)
- [ ] 안건별 SQLite DB 완성
- [ ] 상세 페이지 구현
- [ ] RAG 챗봇 베타 버전
- [ ] 10개 이상 회의록 파싱

### 중기 (3개월)
- [ ] LLM 자동 요약 기능
- [ ] 사용자 피드백 반영
- [ ] 성능 최적화
- [ ] 배포 및 오픈 베타

### 장기 (6개월)
- [ ] Open API 제공
- [ ] 타 지역 의회 확대
- [ ] 모바일 앱 개발
- [ ] 데이터 분석 대시보드

---

## 부록

### A. 시스템 플로우 다이어그램

```
[데이터 파이프라인]
TXT 회의록
  → Gemini 2.5 Flash (메타데이터 추출)
  → JSON 저장
  → OpenAI Embedding
  → ChromaDB (청크 컬렉션)
  → SQLite (안건 메타데이터)

[검색 파이프라인]
사용자 쿼리
  → Query Analyzer (GPT-4o-mini)
  → Metadata Validator
  → Search Executor (벡터 검색)
  → Result Formatter
  → JSON 응답
  → 프론트엔드 렌더링
```

### B. 주요 파일 구조

```
seoulloc/
├── app.py          # FastAPI 메인 서버
├── query_analyzer.py          # 쿼리 분석 (GPT-4o-mini)
├── metadata_validator.py      # 메타데이터 검증
├── search_executor.py         # 검색 실행
├── search_chromadb.py         # ChromaDB 검색
├── insert_to_chromadb.py      # 청크 DB 삽입
├── insert_agendas_to_chromadb.py  # 안건 DB 삽입 (진행 중)
├── custom_openai_embedding.py # 임베딩 함수
├── html/
│   ├── main.html              # 메인 페이지
│   ├── search.html            # 검색 결과
│   └── details.html           # 안건 상세 (예정)
├── result_txt/                # JSON 파싱 결과
├── chroma_db/                 # ChromaDB 저장소
└── markdown/                  # 문서
```

---

**문의**: 팀 불협화음 (손용훈, 성정현, 심세아)
**GitHub**: (추후 공개)
**작성일**: 2025년 1월
